# 4단계 - 4단계 - 블랙잭(베팅)
## 기능 요구사항
   
**블랙잭 게임을 변형한 프로그램을 구현한다.**      
* 블랙잭 게임은 `딜러`와 `플레이어` 중 **카드의 합이 21 또는 21에 가장 가까운 숫자를 가지는 쪽이 이기는 게임이다.**  
* 플레이어는 **게임을 시작할 때 베팅 금액을 정해야 한다.**  
* 카드의 숫자 계산은 카드 숫자를 기본으로 하며, 
  예외로 **Ace는 1 또는 11로 계산**할 수 있으며, 
  **King, Queen, Jack은 각각 10으로 계산한다.**
* 게임을 시작하면 **플레이어는 두 장의 카드를 지급** 받으며, 
  두 장의 카드 숫자를 합쳐 21을 초과하지 않으면서 21에 가깝게 만들면 이긴다.
  **21을 넘지 않을 경우 원한다면 얼마든지 카드를 계속 뽑을 수 있다.**  
  단, 카드를 추가로 뽑아 **21을 초과할 경우 베팅 금액을 모두 잃게 된다.**  
* **처음 두 장의 카드 합이 21일 경우 블랙잭이 되면 베팅 금액의 1.5 배를 딜러에게 받는다.** 
  딜러와 플레이어가 모두 **동시에 블랙잭인 경우 플레이어는 베팅한 금액을 돌려받는다.**
* **딜러는 처음에 받은 2장의 합계가 16이하이면 반드시 1장의 카드를 추가로 받아야 하고, 17점 이상이면 추가로 받을 수 없다.**
* **딜러가 21을 초과하면 그 시점까지 남아 있던 플레이어들은 가지고 있는 패에 상관 없이 승리해 베팅 금액을 받는다.**

## 설계 
* 사용자 이름들을 입력 받는다.   
* 사용자 이름들을 순회하면서 배팅 금액을 입력받는다.  
* 사용자는 2장의 카드를 드로우한다.  
    * 2장의 카드가 블랙잭이면 -> BlackJack 상태 
    * 2장의 카드가 드로우하면 기본적으로 -> Hit 상태 
    * 더이상 카드를 받지 않는다면 -> Stay 상태   
    * 추가 드로우 이후, 21 초과면 -> Bust 상태
* 딜러는 2장의 카드를 드로우한다.  
    * 2장의 카드가 블랙잭이면 -> BlackJack 상태
    * 카드가 16이하면 -> Hit 상태 -> 다시 드로우
    * 카드가 17이상이면 -> Stay 상태 
    * 카드가 21초과면 -> Bust 상태
* 딜러와 사용자를 각각 비교 
    * 딜러가 버스트 -> 패 상관없이 사용자 승 -> 사용가 버스트여도 승(이부분 미흡)
    * 딜러가 블랙잭 -> 사용자가 블랙잭이여만 무승부 -> 나머지는 승 
      * 딜러가 블랙잭, 사용자가 21히트면 딜러 승 
    * 딜러가 히트 -> 사용자와 비교(블랙잭, 더높은 히트 승) -> 같으면 무승부
* 승무패에 따라서 각각의 비율에 맞는 배팅 금액을 돌려준다.     
* 단, 딜러와 사용자가 무승부면 돌려받는다.  

## 클래스 설계 예시
### 카드 
* [x] 문양 :
  * [] DIAMOND, SPADE, HEART, CLUB 이루어진 Enum
* [x] 끗수 :
  * [x] ACE, TWO, THREE, FOUR, FIVE, SIX, SEVEN, EIGHT, NINE, TEN, KING, QUEEN, JACK
  * [x] 내부 프로퍼티로 점수(스코어)를 가지고 있다.
  * [x] 점수를 외부로 나타낼 수 있어야 한다.    
  * [x] 자기 자신이 ACE 임을 나타낼 수 있어야 한다.
* [x] 점수 : 
  * [x] 정수형 숫자 `0 ~ 32`까지를 나타낼 수 있다.    
  * [x] 캐싱 방식을 이용해서 이미 생성된 객체를 리턴한다.     
  * [x] 다른 점수와 덧셈이 가능하며 불변으로 이루어진다.
* [x] 카드
  * [x] 카드 끗수로 이루어진 조합된 클래스 
  * [x] 점수(스코어)를 외부로 나타낼 수 있어야한다.
  * [x] 문양을 외부로 나타낼 수 있어야 한다.     
* [x] 덱
  * [x] 모든 카드의 종류를 나타내는 Deque<Card> 를 가진 일급 컬렉션 
  * [x] 카드 한 장 뽑을 수 있어야 한다.  
  
### 플레이어
* [x] Hands:
  * [x] 현재 소유하고 있는 카드를 나타내는 ArrayDeque<Card> 를 가진 일급 컬렉션  
  * [x] 총합 스코어를 계산할 수 있어야 한다  
    * [x] 카드에 프로퍼티 끗수의 isAce()와 Score 총합에 따라 Ace 점수를 조절한다.
    * [x] isAce() == true && score <= 11 이하면 가능
  * [x] 사이즈와 총합 스코어를 조합해서 상태를 간접적으로 표현할 수 있어야한다.(isBlackJack() 등등)   
  * [x] 카드 한 장 추가 할 수 있다.     
    * [x] 중복된 카드가 들어올 수 없다.
* [x] State :
  * [x] Hands 를 가지고 래퍼 클래스 
  * [x] 점수를 반환할 수 있어야 한다.(hands.score())
  * [x] 상태마다의 비율을 반환할 수 있어야 한다.(피니시 아닌 경우 예외처리)   
  * [x] Stay()로 전환이 가능할 수 있어야 한다.(러닝 아닌 경우 예외처리) 
  * [x] isFinished()로 피니시 상태임을 알릴 수 있어야한다. 
  * [x] profit(otherState: State, money: Money)로 수익률을 반환한다
  * [x] 다른 스테이트와 비교가 가능할 수 있어야 한다.  
  * [x] 카드를 한장 드로우 할 수 있어야 한다.  
  * [x] 러닝 
    * [x] Ready : 처음 카드를 받기 전 상태를 의미한다.   
    * [x] Hit : 처음 가드를 받은 후 상태를 의미한다.  
  * [x] 피니시 
    * [x] earningsRate(otherState: State) 를 통해서 수익률을 반환한다.
    * [x] profit(otherState: State, money: Money) 를 통해서 이윤을 반환한다.
    * [x] BlackJack: Ready 상태에서 카드를 2개 받은후 21이면 이동되는 상태를 의미한다.  
    * [x] Stay : Hit 상태에서 더 이상 카드를 받지 않을 경우 이동되는 상태를 의미한다.   
    * [x] Bust : Hit 상태에서 21을 초과하면 이동 되는 상태다.
* [x] Name : 
  * [x] 사용자의 이름을 나타낸다.  
  * [x] 널이거나 빈 값, 공백으로 이루어진 값을 들어올 수 없다.  
* [x] Player : 
  * [x] Name 과 PlayerState 의 조합으로 이루어진 인터페이스
  * [x] 다른 플레이어와 매치하는 메서드가 있어야 한다.  
  * [x] isFinished()를 통해 종료된 상태임을 나타낼 수 있어야한다.  
  * [x] draw()를 통해 카드를 한장 추가할 수 있어야한다.   
  * [x] stay()로 변환될 수 있어야 한다.  
  * [x] profit(other: Player, money: Money) 를 통해서 이윤을 반환한다.
* [x] Players : 
  * [x] 플레이어들을 나타내며 List<Player>를 가지는 일급 컬렉션이다.   
* Dealer : 
  * [x] Player 를 구현하는 구현체 클래스이다.  
  * [x] 매치시, 자기 자신이 버스트인 경우, 상대가 무조건 이기는 로직을 작성한다.  
  * [x] 그게 아니면, 정상적인 매치 로직을 사용한다.  
  * [x] draw()를 통해 카드를 한장 추가할 수 있어야한다. -> 구현
    * [x] 처음 2장이 블랙잭인 경우
    * [x] 처음 2장이 Hit인 경우
    * [x] 카드의 합이 16이하인 경우 Hit
    * [x] 카드의 합이 17이상 21이하인 경우 Stay -> stay() 직접 호출
    * [x] 카드의 합이 21초과인 경우 Bust
  * [x] stay()로 변환될 수 있어야 한다. -> 구현
  * [x] profit(other: Player, money: Money) 를 통해서 Gamer 이윤의 반대값을 반환한다.
* GamePlayer :
  * [x] Player 를 구현하는 구현체 클래스이다.
  * [x] 다른 플레이어와 매치하는 메서드가 있어야 한다.
  * [x] 그게 아니면, 정상적인 매치 로직을 사용한다.
  * [x] draw()를 통해 카드를 한장 추가할 수 있어야한다. -> 구현
    * [x] 기존 상태로직대로 상태 변환 
  * [x] stay()로 변환될 수 있어야 한다. -> 구현
  * [x] profit(other: Player, money: Money) 를 통해서 이윤값을 반환한다.
* [x] 배팅 금액(Money) 
  * [x] 0 이상의 `정수`로 이루어진 VO 클래스   
* [x] 배팅들(Bets) 
  * [x] 배팅한 사람과 배팅 금액을 매핑한 Map<Name, Money> 의 일급 컬렉션 
  * [x] betMoney()를 이용하여, 사용자의 당첨금을 계산하고 반환한다.
